




<style type="text/css">
    .OrderFrom {
        margin: 10px 0px;
    }

        .OrderFrom table {
            width: 100%;
        }

    .OrderFromtable tr {
        height: 40px;
    }

        .OrderFromtable tr td {
            width: 25%;
        }

    .OrderFrom table tr td label {
        width: 80px;
        text-align: right;
    }

    .OrderFrom table tr td .easyui-textbox {
        width: 200px;
    }

    .OrderFrom table tr td .easyui-numberspinner {
        width: 200px;
    }

    .OrderFrom table tr td .easyui-combobox {
        width: 200px;
    }

    .scene .easyui-linkbutton {
        margin-left: -5px;
    }

    .scene .l-btn-text {
        line-height: 20px;
    }

    .scene .time_input {
        width: 180px !important;
    }

    .panel-title {
        color: #3071a9;
    }
</style>



<div id="" style="margin-bottom:20px" class="easyui-panel" title="信息"
     data-options="collapsible:true">
    <div class="OrderFrom">
        <table>
            <tr>
                <td>
                    <label for="name"> 转入进口业务方式:</label>
                    <input class="easyui-textbox" type="text" name="text" disabled="disabled" />
                </td>
                <td>
                    <label for="CODE">转入出口业务方式:</label>
                    <input class="easyui-textbox" type="text" name="text" disabled="disabled" />
                </td>
                <td>
                    <label for="name">转出进口业务方式:</label>
                    <input class="easyui-textbox" type="text" name="text" disabled="disabled" />
                </td>
                <td>
                    <label for="">转出出口业务方式:</label>
                    <input class="easyui-textbox" type="text" name="text" disabled="disabled" />
                </td>
            </tr>
            <tr>
                <td>
                    <label for=""> 实际送货日期:</label>
                    <input class="easyui-textbox" type="text" name="text" disabled="disabled" />
                </td>
                <td>
                    <label for="">计划报关日期:</label>
                    <input class="easyui-textbox" type="text" name="text" disabled="disabled" />
                </td>
                <td>
                    <label for="">实际放行日期:</label>
                    <input class="easyui-textbox" type="text" name="text" disabled="disabled" />
                </td>
                <td>
                    <label for="">申报关区:</label>
                    <input class="easyui-textbox" type="text" name="text" disabled="disabled" />
                </td>
            </tr>
        </table>
    </div>
</div>


<div class="easyui-tabs" style="height:auto">
    <div title="原始订单">
        <form class="OrderFrom" method="post" id="OrderFrom1">
            <input type="hidden" name="ID" value="169" />
            <table class="scene">
                <tr>
                    <td>
                        <label for="LIDANTIME"> 理单时间:</label>
                        <input class="easyui-textbox  time_input" id="LIDANTIME" data-options="text:'填充时间'" type="text" name="LIDANTIME" disabled="disabled" />
                        <a href="javascript:void(0)" datatype="LIDAN" class="easyui-linkbutton fillingData"><i class="icon-time"></i></a>
                    </td>
                    <td>
                        <label for="LIDANUSERNAME">理单人:</label>
                        <input class="easyui-textbox " type="text" id="LIDANUSERNAME" name="LIDANUSERNAME" disabled="disabled" />
                    </td>
                    <td>
                        <label for="LIHUOZILIAOTIME"> 理货资料时间:</label>
                        <input class="easyui-textbox time_input" type="text" id="LIHUOZILIAOTIME" name="LIHUOZILIAOTIME" disabled="disabled" />
                        <a href="javascript:void(0)" datatype="LIHUOZILIAO" class="easyui-linkbutton fillingData"><i class="icon-time"></i></a>
                    </td>
                    <td>
                        <label for="LIHUOZILIAOUSERNAME">理货资料人:</label>
                        <input class="easyui-textbox " type="text" id="LIHUOZILIAOUSERNAME" name="LIHUOZILIAOUSERNAME" disabled="disabled" />
                    </td>
                </tr>
                <tr>
                    <td style="text-align:left">
                        <label >是否查检:</label>
                        <input class=""  type="checkbox" name="IFCHAYAN" value="1" />
                    </td>
                    <td>
                        <label for="">查验次数:</label>
                        <input class="easyui-numberspinner" name="CHAYANTIMES"
                               data-options="min:0">
                    </td>
                    <td>
                        <label for="">查验备注:</label>
                        <input class="easyui-textbox" type="text" name="CHAYANREMARK" />
                    </td>

                </tr>
            </table>
        </form>

        <form class="OrderFrom" method="post" id="OrderFrom2">
            <input type="hidden" name="ID" value="170" />
            <table class="scene">
                <tr>
                    <td>
                        <label for="LIDANTIME"> 理单时间:</label>
                        <input class="easyui-textbox  time_input" id="LIDANTIME" data-options="text:'填充时间'" type="text" name="LIDANTIME" disabled="disabled" />
                        <a href="javascript:void(0)" datatype="LIDAN" class="easyui-linkbutton fillingData"><i class="icon-time"></i></a>
                    </td>
                    <td>
                        <label for="LIDANUSERNAME">理单人:</label>
                        <input class="easyui-textbox " type="text" id="LIDANUSERNAME" name="LIDANUSERNAME" disabled="disabled" />
                    </td>
                    <td>
                        <label for="LIHUOZILIAOTIME"> 理货资料时间:</label>
                        <input class="easyui-textbox time_input" type="text" id="LIHUOZILIAOTIME" name="LIHUOZILIAOTIME" disabled="disabled" />
                        <a href="javascript:void(0)" datatype="LIHUOZILIAO" class="easyui-linkbutton fillingData"><i class="icon-time"></i></a>
                    </td>
                    <td>
                        <label for="LIHUOZILIAOUSERNAME">理货资料人:</label>
                        <input class="easyui-textbox " type="text" id="LIHUOZILIAOUSERNAME" name="LIHUOZILIAOUSERNAME" disabled="disabled" />
                    </td>
                </tr>
                <tr>
                    <td style="text-align:left">
                        <label >是否查检:</label>
                        <input class=""  type="checkbox" name="IFCHAYAN" value="1" />
                    </td>
                    <td>
                        <label for="">查验次数:</label>
                        <input class="easyui-numberspinner" name="CHAYANTIMES"
                               data-options="min:0">
                    </td>
                    <td>
                        <label for="">查验备注:</label>
                        <input class="easyui-textbox" type="text" name="CHAYANREMARK" />
                    </td>
                </tr>
            </table>
        </form>

    </div>
    <div title="关联订单">
        <input type="hidden" name="ID" />
        asdsad12312
    </div>
</div>



<div style="text-align:center;padding:5px 0">
    <a class="btn btn-primary" href="javascript:void(0)" onclick="submitForm()">
        <i class="icon-ok"></i> 保存 @ViewData["name"]
    </a>

    <a class="btn btn-primary" href="javascript:void(0)" onclick="javascript: history.back(-1);">
        <i class="icon-reply"></i> 返回
    </a>
</div>

<div id="" class="easyui-panel" title="报关单信息"
     data-options="collapsible:true">

    <table id="dg" style="height:250px" class="easyui-datagrid"
           data-options=" rownumbers:true,
                                   dataType : 'json',
                                   method:'get'">
        <thead>
            <tr>
                <th data-options="field: 'ck', checkbox: true"></th>
                <th data-options="field:'ID',sortable:true,width:50,align:'center'">ID</th>
                <th data-options="field:'BUSIUNITNAME',sortable:true,width:200,align:'center'">报关单号</th>
                <th data-options="field:'TOTALNO',width:100,align:'center'">报关张数</th>
                <th data-options="field:'DIVIDENO',width:100,align:'center'">贸易方式</th>
                <th data-options="field:'GOODSNUM',width:50,align:'center'">件数</th>
                <th data-options="field:'GOODSWEIGHT',width:50,align:'center'">总重量</th>
                <th data-options="field:'DECLSHEETNUM',width:100,align:'center'">报关备注</th>
                <th data-options="field:'LAWCONDITION',width:50,align:'center'">删单</th>
                <th data-options="field:'DECLSHEETNUM',width:100,align:'center'">改单次数</th>
                <th data-options="field:'DECLSHEETNUM',width:100,align:'center'">预知单号</th>
                <th data-options="field:'DECLSHEETNUM',width:50,align:'center'">金额</th>
                <th data-options="field:'DECLSHEETNUM',width:100,align:'center'">代垫标志</th>
                <th data-options="field:'DECLSHEETNUM',width:100,align:'center'">垫税类型</th>
                <th data-options="field:'DECLSHEETNUM',width:100,align:'center'">手册号</th>
                <th data-options="field:'DECLSHEETNUM',width:100,align:'center'">手册状态</th>
                <th data-options="field:'DECLSHEETNUM',width:100,align:'center'">出保时间</th>
                <th data-options="field:'DECLSHEETNUM',width:100,align:'center'">QP关联字段</th>
                <th data-options="field:'DECLSHEETNUM',width:100,align:'center'">海关通关状态</th>
                <th data-options="field:'DECLSHEETNUM',width:100,align:'center'">抓取标志</th>
            </tr>
        </thead>
    </table>




</div>



<script type="text/javascript">
    var str = '@Html.Raw(ViewData["name"])';
    function formatItem(row) {
        var s = '<span style="font-weight:bold">' + row.CODE + '</span> &nbsp;&nbsp;' +
                '<span style="color:#888">' + row.NAME + '</span>';
        return s;
    }

    function submitForm() {
        var is_success = true;
        var j = 0;
        //$('.easyui-tabs .OrderFrom').each(function (i) {

        //    $('.easyui-tabs .OrderFrom').eq(i).form('submit', {
        //        url: "/Order/SaveData",
        //        onSubmit: function () {
        //            if ($(this).form('enableValidation').form('validate')) {
        //                return true;
        //            } else {
        //                return false;
        //            }
        //        },
        //        success: function (data) {
        //            debugger;
        //            ++j;
        //            var data = eval('(' + data + ')');  // change the JSON string to javascript object
        //            if (!data.Success) {
        //                is_success = false;
        //            }
        //        }
        //    });
        //});
        

        $('.easyui-tabs #OrderFrom1').form('submit', {
            url: "/Order/SaveData",
            onSubmit: function () {
                if ($(this).form('enableValidation').form('validate')) {
                    return true;
                } else {
                    return false;
                }
            },
            success: function (data) {
                var data = eval('(' + data + ')');  // change the JSON string to javascript object
                if (!data.Success) {
                    is_success = false;
                }
            }
        });


        //$('.easyui-tabs #OrderFrom2').form('submit', {
        //    url: "/Order/SaveData",
        //    onSubmit: function () {
        //        if ($(this).form('enableValidation').form('validate')) {
        //            return true;
        //        } else {
        //            return false;
        //        }
        //    },
        //    success: function (data) {
        //        var data = eval('(' + data + ')');  // change the JSON string to javascript object
        //        if (!data.Success) {
        //            is_success = false;
        //        }
        //    }
        //});



        //$('.easyui-tabs .OrderFrom').form('submit', {
        //    url: "/Order/SaveData",
        //    onSubmit: function () {
        //        if ($(this).form('enableValidation').form('validate')) {
        //            return true;
        //        } else {
        //            return false;
        //        }
        //    },
        //    success: function (data) {
        //        var data = eval('(' + data + ')');  // change the JSON string to javascript object
        //        if (!data.Success) {
        //            is_success = false;
        //        }
        //    }
        //});

        if (is_success) {
            $.messager.alert('成功', '保存成功');
        }
    }


    function loadsucc(data) {
        var PASSMODE = data['PASSMODE'];
        if (PASSMODE != "") {
            var arr = PASSMODE.split(',');
            for (i = 0; i < arr.length; i++) {
                $('input[name=PASSMODE][value=' + arr[i] + ']')[0].checked = true;
            }
        }

    }

    //$('#OrderFrom').form({ onLoadSuccess: loadsucc });

    $('#OrderFrom1').form('load', '/Order/Edit_Order?ID=' + 169);


    $('#OrderFrom2').form('load', '/Order/Edit_Order?ID=' + 170);

    var type;
    var form;
    $('.fillingData').click(function () {
        debugger;
        type = this.getAttribute("datatype");
        form = $(this).parents('.OrderFrom').attr('id');//查找哪个form
        var findname = "#" + form + " input[name=ID]";
        var ID = $(findname).val();
        $.ajax({
            url: '/Order/Edit_Ajax_Scene',// 跳转到 action
            data: {
                'ID': ID,
                'type': type
            },
            type: 'post',
            dataType: 'json',
            success: function (data) {
                debugger;
                if (data.Success == true) {
                    var time = "#" + form + " #" + type + 'TIME';
                    var name = "#" + form + " #" + type + 'USERNAME';
                    $(time).textbox('setValue', data.datetime);
                    $(name).textbox('setValue', data.name);
                } else {
                    $.messager.alert('异常', '联系管理员');
                }
            },

        });

    });

</script>
